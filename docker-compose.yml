version: '2'
services:
  ollama:
    build:
      context: .
      dockerfile: ./Dockerfile
    labels:
      lagoon.type: basic-persistent
      lagoon.persistent: /root/.ollama
    volumes:
      - ./root/.ollama:/home/ollama/.ollama:delegated
    platform: linux/amd64
    ports:
      - 11435:11434
    pull_policy: always
    tty: true
    restart: always
  nginx:
    build:
      context: .
      dockerfile: ./Dockerfile.nginx
    labels:
      lagoon.type: basic
      lagoon.autogeneratedroute: true
    ports:
      - "80:80"
    depends_on:
      - ollama
    restart: always
